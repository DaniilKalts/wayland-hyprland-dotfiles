# ╔═══════════════════════════════════════════════════════════════════════════╗
# ║  ██╗  ██╗██╗   ██╗██████╗ ██████╗ ██╗      █████╗ ███╗   ██╗██████╗       ║
# ║  ██║  ██║╚██╗ ██╔╝██╔══██╗██╔══██╗██║     ██╔══██╗████╗  ██║██╔══██╗      ║
# ║  ███████║ ╚████╔╝ ██████╔╝██████╔╝██║     ███████║██╔██╗ ██║██║  ██║      ║
# ║  ██╔══██║  ╚██╔╝  ██╔═══╝ ██╔══██╗██║     ██╔══██║██║╚██╗██║██║  ██║      ║
# ║  ██║  ██║   ██║   ██║     ██║  ██║███████╗██║  ██║██║ ╚████║██████╔╝      ║
# ║  ╚═╝  ╚═╝   ╚═╝   ╚═╝     ╚═╝  ╚═╝╚══════╝╚═╝  ╚═╝╚═╝  ╚═══╝╚═════╝       ║
# ╚═══════════════════════════════════════════════════════════════════════════╝


# ┌───────────────────────────────────────────────────────────────────────────┐
# │                              MONITORS                                     │
# └───────────────────────────────────────────────────────────────────────────┘

monitor = , preferred, auto, 1


# ┌───────────────────────────────────────────────────────────────────────────┐
# │                              AUTOSTART                                    │
# └───────────────────────────────────────────────────────────────────────────┘

exec-once = ~/.local/bin/waybar-restart.sh
exec-once = dunst
exec-once = hypridle
exec-once = swaybg -i ~/wallpapers/arch.png -m fill
exec-once = /usr/lib/polkit-gnome/polkit-gnome-authentication-agent-1
exec-once = wl-paste --type text --watch cliphist store
exec-once = wl-paste --type image --watch cliphist store

# GTK Theming (gsettings required for Wayland)
exec = gsettings set org.gnome.desktop.interface gtk-theme 'Dracula'
exec = gsettings set org.gnome.desktop.interface icon-theme 'Dracula'
exec = gsettings set org.gnome.desktop.interface cursor-theme 'Dracula-cursors'
exec = gsettings set org.gnome.desktop.interface color-scheme 'prefer-dark'


# ┌───────────────────────────────────────────────────────────────────────────┐
# │                         ENVIRONMENT VARIABLES                             │
# └───────────────────────────────────────────────────────────────────────────┘

env = XCURSOR_SIZE,24
env = XCURSOR_THEME,Dracula-cursors
env = GTK_THEME,Dracula
env = QT_QPA_PLATFORMTHEME,qt6ct
env = QT_QPA_PLATFORM,wayland;xcb
env = GDK_BACKEND,wayland,x11
env = SDL_VIDEODRIVER,wayland
env = CLUTTER_BACKEND,wayland
env = XDG_CURRENT_DESKTOP,Hyprland
env = XDG_SESSION_TYPE,wayland
env = XDG_SESSION_DESKTOP,Hyprland
env = ELECTRON_OZONE_PLATFORM_HINT,auto


# ┌───────────────────────────────────────────────────────────────────────────┐
# │                           GENERAL SETTINGS                                │
# └───────────────────────────────────────────────────────────────────────────┘

general {
    gaps_in = 7
    gaps_out = 14
    border_size = 4
    col.active_border = rgba(bd93f9ff)
    col.inactive_border = rgba(44475aff)
    layout = dwindle
    resize_on_border = true
}


# ┌───────────────────────────────────────────────────────────────────────────┐
# │                             DECORATION                                    │
# └───────────────────────────────────────────────────────────────────────────┘

decoration {
    rounding = 10
    active_opacity = 1.0
    inactive_opacity = 1.0

    shadow {
        enabled = false
    }

    blur {
        enabled = false
    }
}


# ┌───────────────────────────────────────────────────────────────────────────┐
# │                             ANIMATIONS                                    │
# └───────────────────────────────────────────────────────────────────────────┘

animations {
    enabled = true

    bezier = easeOutQuint, 0.23, 1, 0.32, 1
    bezier = easeInOutCubic, 0.65, 0, 0.35, 1
    bezier = linear, 0, 0, 1, 1
    bezier = almostLinear, 0.5, 0.5, 0.75, 1.0
    bezier = quick, 0.15, 0, 0.1, 1

    animation = global, 1, 10, default
    animation = border, 1, 5.39, easeOutQuint
    animation = windows, 1, 4.79, easeOutQuint
    animation = windowsIn, 1, 4.1, easeOutQuint, popin 87%
    animation = windowsOut, 1, 1.49, linear, popin 87%
    animation = fadeIn, 1, 1.73, almostLinear
    animation = fadeOut, 1, 1.46, almostLinear
    animation = fade, 1, 3.03, quick
    animation = workspaces, 1, 1.94, almostLinear, fade
    animation = workspacesIn, 1, 1.21, almostLinear, fade
    animation = workspacesOut, 1, 1.94, almostLinear, fade
}


# ┌───────────────────────────────────────────────────────────────────────────┐
# │                               INPUT                                       │
# └───────────────────────────────────────────────────────────────────────────┘

input {
    kb_layout = us,ru
    kb_options = grp:alt_shift_toggle
    follow_mouse = 1
    sensitivity = 0

    touchpad {
        natural_scroll = true
        disable_while_typing = true
        tap-to-click = true
    }
}

# 3-finger horizontal swipe to switch workspaces
gesture = 3, horizontal, workspace

# 2-finger pinch to toggle fullscreen (like browser zoom)
gesture = 2, pinchin, dispatcher, fullscreen, 0
gesture = 2, pinchout, dispatcher, fullscreen, 0


# ┌───────────────────────────────────────────────────────────────────────────┐
# │                              DWINDLE                                      │
# └───────────────────────────────────────────────────────────────────────────┘

dwindle {
    pseudotile = true
    preserve_split = true
    force_split = 2
}


# ┌───────────────────────────────────────────────────────────────────────────┐
# │                               MASTER                                      │
# └───────────────────────────────────────────────────────────────────────────┘

master {
    new_status = master
}


# ┌───────────────────────────────────────────────────────────────────────────┐
# │                                MISC                                       │
# └───────────────────────────────────────────────────────────────────────────┘

misc {
    disable_hyprland_logo = true
    disable_splash_rendering = true
    force_default_wallpaper = 0
    vfr = true
    vrr = 0
}


# ┌───────────────────────────────────────────────────────────────────────────┐
# │                            WINDOW RULES                                   │
# └───────────────────────────────────────────────────────────────────────────┘

windowrulev2 = float, class:^(pavucontrol)$
windowrulev2 = float, class:^(nm-connection-editor)$
windowrulev2 = float, class:^(blueman-manager)$
windowrulev2 = float, class:^(yad)$
windowrulev2 = float, title:^(Open File)$
windowrulev2 = float, title:^(Save File)$
windowrulev2 = float, title:^(Picture-in-Picture)$
windowrulev2 = opacity 0.96 0.96, class:^(kitty)$


# ┌───────────────────────────────────────────────────────────────────────────┐
# │                            LAYER RULES                                    │
# └───────────────────────────────────────────────────────────────────────────┘

layerrule = noanim, waybar


# ┌───────────────────────────────────────────────────────────────────────────┐
# │                        WOFI WINDOW RULES                                  │
# └───────────────────────────────────────────────────────────────────────────┘

# Wofi uses normal_window=true, so it's a regular window
windowrulev2 = float, class:^(wofi)$
windowrulev2 = animation fade, class:^(wofi)$
windowrulev2 = pin, class:^(wofi)$
windowrulev2 = stayfocused, class:^(wofi)$
windowrulev2 = noborder, class:^(wofi)$


# ╔═══════════════════════════════════════════════════════════════════════════╗
# ║                            KEYBINDINGS                                    ║
# ╚═══════════════════════════════════════════════════════════════════════════╝

$mod = SUPER


# ┌───────────────────────────────────────────────────────────────────────────┐
# │                         WINDOW MANAGEMENT                                 │
# └───────────────────────────────────────────────────────────────────────────┘

bind = $mod, W, killactive
bind = $mod SHIFT, W, exec, ~/.local/bin/force-kill.sh
bind = $mod, N, exec, bash -c 'WIN=$(hyprctl activewindow -j); [ "$(echo "$WIN" | jq -r '\''.fullscreen'\'')" != "0" ] && hyprctl dispatch fullscreen 0; [ "$(echo "$WIN" | jq -r '\''.floating'\'')" = "true" ] && hyprctl dispatch togglefloating'
bind = $mod SHIFT, T, pseudo
bind = $mod, S, exec, bash -c 'WIN=$(hyprctl activewindow -j); [ "$(echo "$WIN" | jq -r '\''.fullscreen'\'')" != "0" ] && hyprctl dispatch fullscreen 0; [ "$(echo "$WIN" | jq -r '\''.floating'\'')" = "false" ] && { hyprctl dispatch togglefloating; sleep 0.1; hyprctl dispatch resizewindowpixel 1200 800; hyprctl dispatch centerwindow; }'
bind = $mod, F, exec, bash -c '[ "$(hyprctl activewindow -j | jq -r '\''.fullscreen'\'')" = "0" ] && hyprctl dispatch fullscreen 0'

# Focus windows (vim keys)
bind = $mod, H, movefocus, l
bind = $mod, J, movefocus, d
bind = $mod, K, movefocus, u
bind = $mod, L, movefocus, r

# Toggle active border highlight (Super + Ctrl + H)
bind = $mod CTRL, H, exec, hyprctl keyword general:col.active_border $(hyprctl getoption general:col.active_border | grep -q "bd93f9" && echo "rgba(44475aff)" || echo "rgba(bd93f9ff)")

# Toggle window visibility in current workspace
bind = $mod SHIFT, H, exec, ~/.local/bin/toggle-window-visibility.sh

# Move windows
bind = $mod SHIFT, J, movewindow, d
bind = $mod SHIFT, K, movewindow, u
bind = $mod SHIFT, L, movewindow, r

# Focus last window
bind = $mod, grave, focuscurrentorlast

# Cycle windows
bind = $mod, Tab, cyclenext
bind = $mod SHIFT, Tab, cyclenext, prev

# Resize windows
bind = $mod ALT, H, resizeactive, -40 0
bind = $mod ALT, J, resizeactive, 0 40
bind = $mod ALT, K, resizeactive, 0 -40
bind = $mod ALT, L, resizeactive, 40 0

# Move floating windows
bind = $mod, Left, moveactive, -20 0
bind = $mod, Down, moveactive, 0 20
bind = $mod, Up, moveactive, 0 -20
bind = $mod, Right, moveactive, 20 0

# Rotate layout
bind = $mod, R, togglesplit

# Mouse bindings
bindm = $mod, mouse:272, movewindow
bindm = $mod, mouse:273, resizewindow


# ┌───────────────────────────────────────────────────────────────────────────┐
# │                             WORKSPACES                                    │
# └───────────────────────────────────────────────────────────────────────────┘

bind = $mod, 1, workspace, 1
bind = $mod, 2, workspace, 2
bind = $mod, 3, workspace, 3
bind = $mod, 4, workspace, 4
bind = $mod, 5, workspace, 5
bind = $mod, 6, workspace, 6
bind = $mod, 7, workspace, 7

bind = $mod SHIFT, 1, movetoworkspace, 1
bind = $mod SHIFT, 2, movetoworkspace, 2
bind = $mod SHIFT, 3, movetoworkspace, 3
bind = $mod SHIFT, 4, movetoworkspace, 4
bind = $mod SHIFT, 5, movetoworkspace, 5
bind = $mod SHIFT, 6, movetoworkspace, 6
bind = $mod SHIFT, 7, movetoworkspace, 7

bind = $mod CTRL, 1, movetoworkspacesilent, 1
bind = $mod CTRL, 2, movetoworkspacesilent, 2
bind = $mod CTRL, 3, movetoworkspacesilent, 3
bind = $mod CTRL, 4, movetoworkspacesilent, 4
bind = $mod CTRL, 5, movetoworkspacesilent, 5
bind = $mod CTRL, 6, movetoworkspacesilent, 6
bind = $mod CTRL, 7, movetoworkspacesilent, 7

bind = $mod, mouse_down, workspace, e+1
bind = $mod, mouse_up, workspace, e-1


# ┌───────────────────────────────────────────────────────────────────────────┐
# │                       APPLICATIONS & UTILITIES                            │
# └───────────────────────────────────────────────────────────────────────────┘

bind = $mod, Return, exec, kitty --directory ~
bind = $mod, Escape, exec, hyprlock
bind = $mod, I, exec, loginctl lock-session && sleep 1 && systemctl suspend
bind = $mod ALT, Q, exit
bind = $mod, M, exec, kitty --directory ~ btop
bind = $mod, E, exec, thunar ~
bind = $mod, D, exec, wofi --show drun
bind = $mod, Q, exec, ~/.local/bin/powermenu.sh
bind = $mod, C, exec, ~/.local/bin/aimenu.sh
bind = $mod, T, exec, kitty --directory ~ tmux


# ┌───────────────────────────────────────────────────────────────────────────┐
# │                        WEB & COMMUNICATION                                │
# └───────────────────────────────────────────────────────────────────────────┘

bind = ALT, F, exec, firefox-developer-edition
bind = ALT, G, exec, ~/.local/bin/open-url.sh https://mail.google.com/mail/u/0/#inbox
bind = ALT, W, exec, ~/.local/bin/open-url.sh https://web.whatsapp.com/
bind = ALT, T, exec, telegram-desktop
bind = ALT, Y, exec, ~/.local/bin/open-url.sh https://youtube.com/
bind = $mod ALT, T, exec, teams


# ┌───────────────────────────────────────────────────────────────────────────┐
# │                        DEVELOPMENT TOOLS                                  │
# └───────────────────────────────────────────────────────────────────────────┘

bind = ALT, O, exec, obsidian
bind = ALT, H, exec, ~/.local/bin/open-url.sh https://github.com/
bind = ALT, I, exec, ~/.local/bin/open-url.sh https://ticktick.com/signin
bind = ALT, R, exec, ~/.local/bin/open-url.sh https://roadmap.sh/
bind = ALT, E, exec, ~/.local/bin/open-url.sh https://chat.openai.com/
bind = ALT, X, exec, ~/.local/bin/open-url.sh https://excalidraw.com/
bind = ALT, L, exec, ~/.local/bin/open-url.sh https://leetcode.com/
bind = ALT, Q, exec, ~/.local/bin/open-url.sh https://monkeytype.com/
bind = ALT, C, exec, cursor
bind = ALT, P, exec, hyprpicker -a


# ┌───────────────────────────────────────────────────────────────────────────┐
# │                        SCREENSHOTS & MEDIA                                │
# └───────────────────────────────────────────────────────────────────────────┘

bind = $mod, P, exec, mkdir -p ~/Pictures/screenshots && grim ~/Pictures/screenshots/screenshot-$(date +%Y%m%d-%H%M%S).png
bind = $mod SHIFT, P, exec, mkdir -p ~/Pictures/screenshots && grim -g "$(slurp)" ~/Pictures/screenshots/screenshot-$(date +%Y%m%d-%H%M%S).png
bind = $mod CTRL, P, exec, grim - | wl-copy
bind = $mod CTRL SHIFT, P, exec, grim -g "$(slurp)" - | wl-copy
bind = $mod SHIFT, S, exec, ~/.local/bin/wallpaper_selector.sh
bind = $mod, V, exec, obs
bind = $mod, B, exec, killall -SIGUSR1 waybar


# ┌───────────────────────────────────────────────────────────────────────────┐
# │                           SOUND CONTROL                                   │
# └───────────────────────────────────────────────────────────────────────────┘

bind = ALT, M, exec, ~/.local/bin/volume.sh toggle
bindel = ALT, K, exec, ~/.local/bin/volume.sh up
bindel = ALT, J, exec, ~/.local/bin/volume.sh down

bindel = , XF86AudioRaiseVolume, exec, ~/.local/bin/volume.sh up
bindel = , XF86AudioLowerVolume, exec, ~/.local/bin/volume.sh down
bindl = , XF86AudioMute, exec, ~/.local/bin/volume.sh toggle
bindl = , XF86AudioPlay, exec, playerctl play-pause
bindl = , XF86AudioPrev, exec, playerctl previous
bindl = , XF86AudioNext, exec, playerctl next


# ┌───────────────────────────────────────────────────────────────────────────┐
# │                         BRIGHTNESS CONTROL                                │
# └───────────────────────────────────────────────────────────────────────────┘

bindel = , XF86MonBrightnessUp, exec, brightnessctl set 5%+
bindel = , XF86MonBrightnessDown, exec, brightnessctl set 5%-
bindel = , F8, exec, brightnessctl set 5%+
bindel = , F7, exec, brightnessctl set 5%-


# ┌───────────────────────────────────────────────────────────────────────────┐
# │                          CLIPBOARD HISTORY                                │
# └───────────────────────────────────────────────────────────────────────────┘

bind = $mod SHIFT, C, exec, cliphist list | wofi --dmenu | cliphist decode | wl-copy
